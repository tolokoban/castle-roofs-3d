require("step005",function(e,o){"use strict";var r=require("lights"),s=require("castles"),a=require("mesh-factory-005"),t=require("three.canvas"),l=new THREE.Color(65280),c=new THREE.Color(9457664),d=(new THREE.Color(255),new THREE.MeshStandardMaterial({metalness:.1,roughness:.5,vertexColors:THREE.VertexColors}),function(e){t.call(this,e),r["default"](this.scene);var o=new THREE.Group;this.scene.add(o),this._grp=o;var d=parseInt(e.castle);isNaN(d)&&(d=0);var i,n,p,h,f,u,w,E,g=(new THREE.TextureLoader).load("css/gfx/wall.jpg"),T=(new THREE.TextureLoader).load("css/gfx/wall-bump.jpg"),m=(new THREE.TextureLoader).load("css/gfx/grass.jpg"),R=(new THREE.TextureLoader).load("css/gfx/grass-bump.jpg"),x=new a(new THREE.MeshStandardMaterial({metalness:0,roughness:.7,map:g,bumpMap:T})),H=new a(new THREE.MeshStandardMaterial({metalness:0,roughness:.5,map:m,bumpMap:R})),M=s.getCopyOfCastle(d);for(M.heights.forEach(function(e,o){if(!(1>e)){var r=o%M.cols,s=(o-r)/M.rows;H.addQuad({pos:[r-M.cols/2,e,s-M.rows/2],color:l,dir:"Y"})}}),n=0;n<M.rows;n++)for(f=n-M.rows/2,w=0,i=0;i<M.cols;i++){if(p=i-M.cols/2,E=M.heights[n*M.cols+i],E>w)for(u=w+1;E>=u;u++)h=u-.5,x.addQuad({pos:[p,h,f],color:c,dir:"X"});w=E}for(n=0;n<M.rows;n++)for(f=n-M.rows/2,w=0,i=M.cols-1;i>=0;i--){if(p=i-M.cols/2+1,E=M.heights[n*M.cols+i],E>w)for(u=w+1;E>=u;u++)h=u-.5,x.addQuad({pos:[p,h,f],color:c,dir:"x"});w=E}for(i=0;i<M.cols;i++)for(p=i-M.cols/2,w=0,n=M.rows-1;n>=0;n--){if(f=n-M.rows/2+1,E=M.heights[n*M.cols+i],E>w)for(u=w+1;E>=u;u++)h=u-.5,x.addQuad({pos:[p,h,f],color:c,dir:"Z"});w=E}for(i=0;i<M.cols;i++)for(p=i-M.cols/2,w=0,n=0;n<M.rows;n++){if(f=n-M.rows/2,E=M.heights[n*M.cols+i],E>w)for(u=w+1;E>=u;u++)h=u-.5,x.addQuad({pos:[p,h,f],color:c,dir:"z"});w=E}o.add(x.toMesh(),H.toMesh()),this.setCamera(e.cameraX||4,e.cameraY||4,e.cameraZ||0,0,3,0),this._speed1=3e-4,this.start()});d.prototype=Object.create(t.prototype),d.prototype.constructor=d,d.prototype.onRender=function(e,o){this._grp.rotation.y=e*this._speed1},o.exports=d});
//# sourceMappingURL=step005.js.map